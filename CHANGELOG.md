# Список изменений
___
В данном файле поэтапно изложены все изменения проекта

Формат списка изменений - [Keep a Changelog](https://keepachangelog.com/ru/1.0.0/). Проект следует [семантическому версионированию](https://semver.org/lang/ru/)

## [v0.10.0] - 2022.08.01
### Добавлено

- Класс для оборачивания результатов (`Results`)
- Проработаны ошибочные ситуации для входящих данных в реализациях репозиториев
- Метод определения типа контента
- Ошибка Forbidden
- Плагин с настройкой для создания executable jar

### Исправлено

- Алгоритм проверки роли пользователя при авторизации в UseCase'ах

### Удалено

- Тесты в проекте (удалены в связи с неработоспособностью)

### Изменено

- CascadeType в `TaskMapper` на REMOVE
- Стилистические изменения, мелкие коррективы, в том числе Javadoc

## [v0.9.0] - 2022.07.30
### Добавлено

- Обработка ошибки "Уже существует"
- Шифрование пароля при помощи bcrypt (механизмами Spring Security)
- Ограничение на создание пользователя при уже существующем в БД (по электронной почте)
- Обработка ошибочной ситуации, связанной с пунктом выше.
- Реализация UserAuthentication для хранения идентификатора пользователя в деталях (details)
  - _**Пояснение**_: решение было принято для того, чтобы использовать средства Spring Security "на максимум" и подчеркнуть
  ясность взаимодействия компонентов авторизации в системе.
- Сохранение контента в директорию статических ресурсов.
- Методы и представления для получения нового access-токена по refresh-токену.
- Указан `spring-boot-starter-parent` в качестве родителя проекта.

### Изменено

- `File.Format` и `Content.Format` были переименованы в `ContentFormat` и `FileFormat` для устранения 
  конфликта при их совместном использовании с `java.io.File` (конфликт импортов)
- **Увеличен максимальный размер входящих файлов** (50 ГБ). В следующих версиях планируется снизить данное ограничение.

### Исправлено

- Проект приведен к Google Code Style при помощи плагина `CheckStyle-IDEA`
- Проведен небольшой рефакторинг кода и исправлены небольшие ошибки.
- Исправлена ошибка при обновлении задачи (дата создания постоянно устанавливалась текущая из-за создания 
  нового объекта `TaskMapper` в репозитории).
- Ошибки в README.md и текущем файле.
- `server.port` - настройка Tomcat'а в `application.properties` также была удалена (установлен порт по умолчанию - 8080)

## [v0.8.0] - 2022.07.29
### Добавлено

- Написаны JavaDoc
- Интерфейсы и DTO для базовых сущностей
- Зависимость Apache Tika
- Классы для работы с задачами
- Классы для работы с файлами
- Вспомогательный класс `FileHelper` для файлов
- Обработка единственной ошибки InvalidValue
- Ограничение на размер входящих файлов в классе `Application` (10 МБ)
- Конфигурация директории, содержащей статические ресурсы
- Новые ошибки для задач и файлов. Имеются в виду элементы перечисления, конечно :)
- К проекту подключен Spring Security и Java JWT
- Получение пользователя по Email, соответствующий метод валидации в `ValuesValidator`
- Реализована аутентификация, соответствующие реализации UserDetails, UserDetailsService
- Реализована авторизация в UseCase'ах
- Реализованы операции для получения JWT-токена

### Исправлено

- Ошибка игнорирования исключения при удалении пользователя
- Исправление мелких ошибок, корректировки JavaDoc

## [v0.7.0] - 2022.07.16
### Добавлено

- Класс-контейнер для InvalidValue
- Обработчик ошибок @ControllerAdvice
- Проработаны ошибочные ситуации
- Класс, инкапсулирующий логику преобразования DTO ошибок в исключения

### Изменено

- Версии Spring, Mockito, AssertJ
- Откорректирован Javadoc
- Структура Failure возвращена к исходной: `abstract class` → `interface`, кроме того:
- Классы-ошибки, реализующие интерфейс Failure - стали перечислениями `enum` для удобного пользования
- Проверка входных данных приложения по-прежнему проводится в доменном слое (UseCase'ах), однако
логика валидации была перенесена в отдельный класс и добавлена во все UseCase пользователя
- ValuesValidator переделан в соответствии с новым классом InvalidValuesContainer
- Класс Role был переделан в соответствии с изменившейся спецификации
- User переделан в интерфейс
- Полностью переделаны тесты

### Исправлено

- Драйвер PostgreSQL, стартер для Spring Data JPA - зависимости, без которых не работало приложение
  (не попали в предыдущую версию)
- Ошибки валидации
- Тип возвращаемого значения операции delete изменен на void (согласно спецификации)
- Ошибки импортов
- Ошибка, при которой возвращалось только наименование роли

### Удалено

- Apache Common Codec зависимость
- Неиспользуемый метод в UseCase'ах
- Интерфейс UseCase
- Класс UserParams
- Утилитный класс Users

## [v0.6.0] - 2022.07.11
### Добавлено

- Тест и реализация UsersServiceImpl
- Конструктор с валидацией для класса Role
- JPA репозиторий для пользователей
- Представление пользователя в БД
- Конфигурация проекта для подключения к PostgreSQL

### Изменено

- Тип аватара `byte[]` → `String`
- Методы репозитория пользователей

### Исправлено

- Добавлена аннотация @Async там, где её не было

### Удалено

- Класс DataTransferObject
- SearchUsers и связанные с ним классы

## [v0.5.0] - 2022.06.17
### Добавлено

- К проекту подключен Spring
- Специальный класс для валидации данных, тесты для него
- Интерфейс UsersService, его стандартная реализация
- Реализация методов UsersController

### Изменено

- Пакетная структура проекта
- Future заменён на CompletableFuture


## [v0.4.0]- 2022.05.28
### Добавлено

- Фабричный метод пользователя и тест для него
- Подключены зависимости Apache Commons (Validator, Codec) для валидации данных
- Верификация полей пользователя в фабричном методе User'a `create()`
- Метод получения случайной роли в классе Users
- Базовый класс DTO и его реализации для пользователя

### Изменено

- Откорректирован pom.xml: разрешен конфликт зависимостей (исключена транзитивная зависимость одной из библиотек)
- Структура Failure: `interface` → `abstract class`. Добавлен конструктор с сообщением (также для дочерних классов)
- Переименован класс `UserRole` → `Role`

### Исправлено

- Ошибка генерации отрицательного идентификатора в классе Users, метод `nextInt()`
- Ошибки в CHANGELOG.md

### Удалено

- Неиспользуемые сущности из пакета entities

## [v0.3.0] - 2022.05.04
### Добавлено

- Реализация сценария поиска пользователей по параметрам
- Добавлены недостающие тесты для сценариев
- Репозиторий пользователей
- Базовый тип сценария UseCase
- Основные реализации сценариев
- Тест для сценария получения пользователя по идентификатору
- Сущность ошибки "Уже существует"
- Утилитный класс Users для работы с пользователями

### Изменено

- Изменен тип возвращаемого значения метода `search()` в классе UserRepository: `List<User>` → `Iterable<User>`

## [v0.2.0] - 2022.04.26
### Добавлено

- Репозиторий пользователей
- Базовый тип сценария UseCase
- Основные реализации сценариев
- Тест для сценария получения пользователя по идентификатору
- Сущность ошибки "Уже существует"
- Утилитный класс Users для работы с пользователями

## v0.1.0 - 2022.04.15
### Добавлено

- Создана заготовка проекта
- Созданы основные сущности
- Описаны зависимости проекта в `README.md`

[v0.2.0]: https://gitlab.study.htc-cs.com/root/java/java-22-1/-/compare/ilya.buldakov-v0.1.0...ilya.buldakov-v0.2.0
[v0.3.0]: https://gitlab.study.htc-cs.com/root/java/java-22-1/-/compare/ilya.buldakov-v0.2.0...ilya.buldakov-v0.3.0
[v0.4.0]: https://gitlab.study.htc-cs.com/root/java/java-22-1/-/compare/ilya.buldakov-v0.3.0...ilya.buldakov-v0.4.0
[v0.5.0]: https://gitlab.study.htc-cs.com/root/java/java-22-1/-/compare/ilya.buldakov-v0.4.0...ilya.buldakov-v0.5.0
[v0.6.0]: https://gitlab.study.htc-cs.com/root/java/java-22-1/-/compare/ilya.buldakov-v0.5.0...ilya.buldakov-v0.6.0
[v0.7.0]: https://gitlab.study.htc-cs.com/root/java/java-22-1/-/compare/ilya.buldakov-v0.6.0...ilya.buldakov-v0.7.0
[v0.8.0]: https://gitlab.study.htc-cs.com/root/java/java-22-1/-/compare/ilya.buldakov-v0.7.0...ilya.buldakov-v0.8.0
[v0.9.0]: https://gitlab.study.htc-cs.com/root/java/java-22-1/-/compare/ilya.buldakov-v0.8.0...ilya.buldakov-v0.9.0
[v0.10.0]: https://gitlab.study.htc-cs.com/root/java/java-22-1/-/compare/ilya.buldakov-v0.9.0...ilya.buldakov-v0.10.0